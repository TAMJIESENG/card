import{_ as M,l as C,r as h,o as L,C as _,R as i,a as f,d as u,f as t,A as p,F as H,g as x,i as d,t as A,e as S,w as b,Q as k,u as B,aJ as I,T as Z}from"./index-ihp2IIuf.js";const D={class:"security-verification"},P={class:"background-decoration"},N={class:"warning-particles"},$={class:"verification-container"},K={class:"security-warning"},R={class:"warning-content"},z={class:"ip-comparison"},E={class:"ip-item trusted"},J={class:"ip-value"},T={class:"ip-item current"},U={class:"ip-value current-ip"},q={class:"key-input-section"},F={class:"input-container"},O={class:"input-form"},Q={class:"security-key-input"},W={class:"verification-actions"},j=["disabled"],G={key:0,class:"button-content"},X={key:1,class:"button-content"},Y=["disabled"],a1={__name:"SecurityVerification",setup(t1){const r=_(),m=C(),o=h(""),s=h(!1),n=h(null);L(()=>{const e=r.currentRoute.value.params.securityData;if(e)n.value=JSON.parse(decodeURIComponent(e));else{const a=sessionStorage.getItem("security_verification_data");a?n.value=JSON.parse(a):(i.error("安全验证会话已过期，请重新登录"),r.push("/login"))}});const V=e=>{const a=Math.random()*6+3,c=Math.random()*8+12,v=Math.random()*4,l=Math.random()*100,y=Math.random()*100;return{width:`${a}px`,height:`${a}px`,left:`${l}%`,top:`${y}%`,animationDuration:`${c}s`,animationDelay:`${v}s`}},g=async()=>{if(!o.value.trim()){i.warning("请输入安全密钥");return}s.value=!0;try{const e=await m.adminSecureLogin({username:"admin",password:sessionStorage.getItem("admin_temp_password")},o.value.trim());e.success?(i.success("安全验证成功，正在跳转..."),sessionStorage.removeItem("security_verification_data"),sessionStorage.removeItem("admin_temp_password"),setTimeout(()=>{r.push("/admin")},1500)):i.error(e.message||"安全密钥验证失败")}catch{i.error("验证过程出现错误，请重试")}finally{s.value=!1}},w=()=>{sessionStorage.removeItem("security_verification_data"),sessionStorage.removeItem("admin_temp_password"),i.info("已取消安全验证"),r.push("/login")};return(e,a)=>{var c,v;return u(),f("div",D,[t("div",P,[a[1]||(a[1]=t("div",{class:"security-shape shape-1"},null,-1)),a[2]||(a[2]=t("div",{class:"security-shape shape-2"},null,-1)),t("div",N,[(u(),f(H,null,x(20,l=>t("div",{class:"warning-particle",key:l,style:Z(V())},null,4)),64))])]),a[16]||(a[16]=p('<div class="emergency-header" data-v-7feac59f><div class="header-container" data-v-7feac59f><div class="alert-section" data-v-7feac59f><div class="alert-icon" data-v-7feac59f><svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" data-v-7feac59f><path d="M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16" data-v-7feac59f></path></svg></div><div class="alert-text" data-v-7feac59f><h1 class="alert-title" data-v-7feac59f>安全验证</h1><p class="alert-subtitle" data-v-7feac59f>检测到异常登录行为</p></div></div><div class="security-level" data-v-7feac59f><div class="level-indicator critical" data-v-7feac59f></div><span data-v-7feac59f>高风险</span></div></div></div>',1)),t("div",$,[t("div",K,[a[8]||(a[8]=t("div",{class:"warning-icon"},[t("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"})])],-1)),t("div",R,[a[6]||(a[6]=t("h2",{class:"warning-title"},"检测到IP地址变更",-1)),a[7]||(a[7]=t("p",{class:"warning-description"}," 为了保护管理员账号安全，系统检测到您的IP地址发生了变化。 请输入安全密钥以继续登录。 ",-1)),t("div",z,[t("div",E,[a[3]||(a[3]=t("div",{class:"ip-label"},[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9V17"})]),d(" 信任IP地址 ")],-1)),t("div",J,A(((c=n.value)==null?void 0:c.trustedIP)||"未知"),1)]),a[5]||(a[5]=t("div",{class:"ip-arrow"},"→",-1)),t("div",T,[a[4]||(a[4]=t("div",{class:"ip-label"},[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z"})]),d(" 当前IP地址 ")],-1)),t("div",U,A(((v=n.value)==null?void 0:v.currentIP)||"未知"),1)])])])]),t("div",q,[t("div",F,[a[13]||(a[13]=p('<div class="input-header" data-v-7feac59f><div class="lock-icon" data-v-7feac59f><svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" data-v-7feac59f><path d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z" data-v-7feac59f></path></svg></div><div class="input-title" data-v-7feac59f><h3 data-v-7feac59f>输入安全密钥</h3><p data-v-7feac59f>请输入从安全密钥生成器获取的一次性密钥</p></div></div>',1)),t("div",O,[t("div",Q,[S(B(I),{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=l=>o.value=l),placeholder:"请输入安全密钥",size:"large",disabled:s.value,onKeyup:k(g,["enter"]),class:"key-input",maxlength:"128","show-word-limit":""},{prefix:b(()=>a[9]||(a[9]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M7,14A3,3 0 0,1 10,17A3,3 0 0,1 7,20A3,3 0 0,1 4,17A3,3 0 0,1 7,14M7,18A1,1 0 0,0 8,17A1,1 0 0,0 7,16A1,1 0 0,0 6,17A1,1 0 0,0 7,18M16,6V10H14V6H16M18,11V7A2,2 0 0,0 16,5H14A2,2 0 0,0 12,7V11A1,1 0 0,0 11,12V16A1,1 0 0,0 12,17H18A1,1 0 0,0 19,16V12A1,1 0 0,0 18,11Z"})],-1)])),_:1},8,["modelValue","disabled"])]),t("div",W,[t("button",{class:"verify-button",onClick:g,disabled:!o.value.trim()||s.value},[s.value?(u(),f("span",X,a[11]||(a[11]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",class:"loading-icon"},[t("path",{d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"})],-1),d(" 验证中... ",-1)]))):(u(),f("span",G,a[10]||(a[10]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9V17"})],-1),d(" 验证并登录 ",-1)])))],8,j),t("button",{class:"cancel-button",onClick:w,disabled:s.value},a[12]||(a[12]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})],-1),d(" 取消登录 ",-1)]),8,Y)])])]),a[14]||(a[14]=p('<div class="help-section" data-v-7feac59f><div class="help-card" data-v-7feac59f><div class="help-icon" data-v-7feac59f><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" data-v-7feac59f><path d="M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C7.59,8 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z" data-v-7feac59f></path></svg></div><div class="help-content" data-v-7feac59f><h4 data-v-7feac59f>如何获取安全密钥？</h4><ol data-v-7feac59f><li data-v-7feac59f>打开安全密钥生成器页面</li><li data-v-7feac59f>点击&quot;生成安全密钥&quot;按钮</li><li data-v-7feac59f>复制生成的密钥</li><li data-v-7feac59f>在上方输入框中粘贴密钥</li></ol><div class="help-actions" data-v-7feac59f><a href="/security-key-generator" target="_blank" class="help-link" data-v-7feac59f><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-v-7feac59f><path d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" data-v-7feac59f></path></svg> 打开密钥生成器 </a></div></div></div></div>',1))]),a[15]||(a[15]=p('<div class="security-tips" data-v-7feac59f><div class="tips-header" data-v-7feac59f><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-v-7feac59f><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17A1.5,1.5 0 0,1 10.5,15.5A1.5,1.5 0 0,1 12,14A1.5,1.5 0 0,1 13.5,15.5A1.5,1.5 0 0,1 12,17M14.5,10.5C14.5,9 13.38,7.75 12,7.75C10.62,7.75 9.5,9 9.5,10.5H11C11,9.65 11.45,9 12,9C12.55,9 13,9.65 13,10.5C13,10.69 12.92,10.87 12.77,11L11.96,11.84C11.54,12.26 11.25,12.74 11.25,13.5H12.75C12.75,13.08 12.85,12.69 13.11,12.43L13.92,11.61C14.33,11.2 14.5,10.87 14.5,10.5Z" data-v-7feac59f></path></svg><h4 data-v-7feac59f>安全提示</h4></div><ul class="tips-list" data-v-7feac59f><li data-v-7feac59f>每个安全密钥只能使用一次，使用后会自动失效</li><li data-v-7feac59f>密钥有时效性，请及时使用以免过期</li><li data-v-7feac59f>请妥善保管您的密钥，不要泄露给他人</li><li data-v-7feac59f>如多次验证失败，系统将暂时锁定管理员账号</li></ul></div>',1))])])}}},s1=M(a1,[["__scopeId","data-v-7feac59f"]]);export{s1 as default};

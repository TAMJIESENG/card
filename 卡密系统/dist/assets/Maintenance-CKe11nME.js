import{_ as N,O as V,l as U,r as M,c as k,o as P,C as R,z,a as u,d as c,f as e,e as n,w as o,h as f,t as r,b as v,k as G,u as i,F as H,g as J,J as y,ax as L,a9 as O,a4 as j,i as b,$ as q,aG as K}from"./index-ihp2IIuf.js";const Q={class:"maintenance-page"},W={class:"maintenance-container"},X={class:"maintenance-header"},Y={class:"maintenance-content"},Z={class:"maintenance-info"},ee={class:"info-item"},te={class:"info-content"},ne={class:"info-item"},se={class:"info-content"},ae={key:0,class:"info-item"},oe={class:"info-content"},le={class:"maintenance-description"},ie={class:"maintenance-notice"},re={key:0,class:"maintenance-timer"},ce={class:"timer-info"},ue={class:"timer-item"},de={class:"timer-value"},me={key:0,class:"timer-item"},_e={class:"timer-value"},fe={class:"maintenance-actions"},ve={class:"background-decoration"},pe={__name:"Maintenance",setup(ge){const d=R(),m=V(),w=U(),p=M(!1),_=M(0),g=M(null),a=k(()=>m.getMaintenanceInfo()),x=k(()=>{if(!a.value.estimatedDuration)return 0;const s=a.value.estimatedDuration,t=_.value;return Math.max(0,s-t)}),D=k(()=>{if(!a.value.estimatedDuration)return 0;const s=_.value/a.value.estimatedDuration*100;return Math.min(100,Math.max(0,s))}),F=s=>({upgrade:"系统升级",security:"安全更新",performance:"性能优化",bugfix:"Bug修复",database:"数据库维护",server:"服务器维护",other:"其他"})[s]||"系统维护",C=s=>{if(s<60)return`${s} 分钟`;{const t=Math.floor(s/60),l=s%60;return l>0?`${t} 小时 ${l} 分钟`:`${t} 小时`}},T=()=>{if(a.value.startTime){const s=new Date(a.value.startTime),t=new Date;_.value=Math.floor((t-s)/(1e3*60))}},A=()=>{p.value=!0;const s=m.checkMaintenanceMode();setTimeout(()=>{s?p.value=!1:d.push("/")},1e3)},S=()=>{d.push("/admin")},B=()=>{d.push("/")};return P(()=>{m.checkMaintenanceMode(),T(),g.value=setInterval(T,6e4),m.isMaintenanceActive()||d.push("/")}),z(()=>{g.value&&clearInterval(g.value)}),(s,t)=>{const l=f("el-icon"),E=f("el-alert"),I=f("el-progress"),h=f("el-button");return c(),u("div",Q,[e("div",W,[e("div",X,[n(l,{class:"maintenance-icon",color:"#F56C6C"},{default:o(()=>[n(i(y))]),_:1}),e("h1",null,r(a.value.title||"系统维护中"),1),t[0]||(t[0]=e("p",{class:"maintenance-subtitle"},"System Under Maintenance",-1))]),e("div",Y,[e("div",Z,[e("div",ee,[n(l,{class:"info-icon",color:"#E6A23C"},{default:o(()=>[n(i(L))]),_:1}),e("div",te,[t[1]||(t[1]=e("h3",null,"维护原因",-1)),e("p",null,r(F(a.value.reason)),1)])]),e("div",ne,[n(l,{class:"info-icon",color:"#409EFF"},{default:o(()=>[n(i(O))]),_:1}),e("div",se,[t[2]||(t[2]=e("h3",null,"预计时长",-1)),e("p",null,r(a.value.estimatedDuration)+" 分钟",1)])]),a.value.contact?(c(),u("div",ae,[n(l,{class:"info-icon",color:"#67C23A"},{default:o(()=>[n(i(j))]),_:1}),e("div",oe,[t[3]||(t[3]=e("h3",null,"联系客服",-1)),e("p",null,r(a.value.contact),1)])])):v("",!0)]),e("div",le,[t[4]||(t[4]=e("h3",null,"维护说明",-1)),e("p",null,r(a.value.description||"系统正在进行维护升级，暂时无法访问。请耐心等待维护完成。"),1)]),e("div",ie,[n(E,{title:"温馨提示",type:"warning",closable:!1},{default:o(()=>t[5]||(t[5]=[e("ul",null,[e("li",null,"维护期间所有功能将暂停使用"),e("li",null,"请耐心等待维护完成"),e("li",null,"如有紧急问题请联系客服"),e("li",null,"感谢您的理解和支持")],-1)])),_:1,__:[5]})]),a.value.startTime?(c(),u("div",re,[t[8]||(t[8]=e("h3",null,"维护进度",-1)),e("div",ce,[e("div",ue,[t[6]||(t[6]=e("span",{class:"timer-label"},"已维护时长：",-1)),e("span",de,r(C(_.value)),1)]),x.value>0?(c(),u("div",me,[t[7]||(t[7]=e("span",{class:"timer-label"},"预计剩余：",-1)),e("span",_e,r(C(x.value)),1)])):v("",!0)]),n(I,{percentage:D.value,"stroke-width":8,"show-text":!1,color:"#409EFF",class:"progress-bar"},null,8,["percentage"])])):v("",!0),e("div",fe,[n(h,{type:"primary",onClick:A,loading:p.value},{default:o(()=>[n(l,null,{default:o(()=>[n(i(q))]),_:1}),t[9]||(t[9]=b(" 刷新页面 ",-1))]),_:1,__:[9]},8,["loading"]),i(w).isAdmin?(c(),G(h,{key:0,type:"success",onClick:S},{default:o(()=>[n(l,null,{default:o(()=>[n(i(y))]),_:1}),t[10]||(t[10]=b(" 管理后台 ",-1))]),_:1,__:[10]})):v("",!0),n(h,{type:"info",onClick:B},{default:o(()=>[n(l,null,{default:o(()=>[n(i(K))]),_:1}),t[11]||(t[11]=b(" 返回首页 ",-1))]),_:1,__:[11]})])]),t[12]||(t[12]=e("div",{class:"maintenance-footer"},[e("p",null,"© 2024 卡密系统. 维护期间给您带来的不便，敬请谅解。")],-1))]),e("div",ve,[(c(),u(H,null,J(6,$=>e("div",{class:"floating-icon",key:$},[n(l,null,{default:o(()=>[n(i(y))]),_:1})])),64))])])}}},Me=N(pe,[["__scopeId","data-v-1e831a31"]]);export{Me as default};

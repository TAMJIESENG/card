import{aE as u,r as l}from"./index-ihp2IIuf.js";const S=u("announcement",()=>{const o=l([]),r=l(!1);return{announcements:o,loading:r,fetchAnnouncements:async()=>{try{r.value=!0;const n=JSON.parse(localStorage.getItem("all_announcements")||"[]");return o.value=n.sort((e,t)=>new Date(t.createTime)-new Date(e.createTime)),{success:!0}}catch{return{success:!1,message:"获取公告失败"}}finally{r.value=!1}},createAnnouncement:async n=>{try{const e=JSON.parse(localStorage.getItem("all_announcements")||"[]"),t={id:Date.now(),title:n.title,content:n.content,type:n.type||"info",priority:n.priority||"normal",status:"published",showOnHome:n.showOnHome||!1,createTime:new Date().toLocaleString("zh-CN"),updateTime:new Date().toLocaleString("zh-CN"),author:n.author||"admin"};return e.unshift(t),localStorage.setItem("all_announcements",JSON.stringify(e)),o.value.unshift(t),{success:!0,message:"公告创建成功",data:t}}catch{return{success:!1,message:"创建公告失败"}}},updateAnnouncement:async(n,e)=>{try{const t=JSON.parse(localStorage.getItem("all_announcements")||"[]"),s=t.findIndex(c=>c.id===n);if(s===-1)return{success:!1,message:"公告不存在"};t[s]={...t[s],title:e.title,content:e.content,type:e.type,priority:e.priority,showOnHome:e.showOnHome,updateTime:new Date().toLocaleString("zh-CN")},localStorage.setItem("all_announcements",JSON.stringify(t));const a=o.value.findIndex(c=>c.id===n);return a!==-1&&(o.value[a]=t[s]),{success:!0,message:"公告更新成功"}}catch{return{success:!1,message:"更新公告失败"}}},deleteAnnouncement:async n=>{try{const t=JSON.parse(localStorage.getItem("all_announcements")||"[]").filter(s=>s.id!==n);return localStorage.setItem("all_announcements",JSON.stringify(t)),o.value=o.value.filter(s=>s.id!==n),{success:!0,message:"公告删除成功"}}catch{return{success:!1,message:"删除公告失败"}}},getHomeAnnouncements:()=>JSON.parse(localStorage.getItem("all_announcements")||"[]").filter(e=>e.showOnHome&&e.status==="published").sort((e,t)=>{const s={high:3,normal:2,low:1};return s[e.priority]!==s[t.priority]?s[t.priority]-s[e.priority]:new Date(t.createTime)-new Date(e.createTime)}),getAnnouncementTypeColor:n=>({info:"#409eff",success:"#67c23a",warning:"#e6a23c",error:"#f56c6c"})[n]||"#409eff",getAnnouncementTypeText:n=>({info:"通知",success:"成功",warning:"警告",error:"错误"})[n]||"通知",getPriorityText:n=>({high:"高",normal:"普通",low:"低"})[n]||"普通"}});export{S as u};

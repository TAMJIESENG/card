import{_ as T,l as $,O as F,r as h,P,c as U,o as q,a as m,d as g,f as e,A as x,b as I,e as l,w as n,Q as E,h as c,i as w,B as y,C as K,R as u}from"./index-ihp2IIuf.js";const G={class:"login-page"},Z={class:"login-container"},D={class:"login-form-section"},J={key:0,class:"maintenance-notice"},O={class:"input-wrapper"},Q={class:"field-label"},W={class:"input-wrapper"},j={class:"captcha-wrapper"},X={class:"input-wrapper captcha-input"},Y={class:"captcha-image-container"},tt={class:"form-options"},et={key:0},at={key:1},st={class:"form-footer"},ot={class:"footer-links"},lt={__name:"Login",setup(rt){const M=K(),V=$(),S=F(),b=h(),f=h(!1),s=P({username:"",password:"",captcha:"",remember:!1}),H={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少 6 个字符",trigger:"blur"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{len:4,message:"验证码长度为4位",trigger:"blur"}]},C=h(),z=h(""),B=U(()=>S.isMaintenanceActive()),L=()=>{const r="ABCDEFGHJKMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789";let t="";for(let a=0;a<4;a++)t+=r.charAt(Math.floor(Math.random()*r.length));z.value=t,N(t)},N=r=>{if(!C.value)return;const t=C.value,a=t.getContext("2d");a.clearRect(0,0,t.width,t.height);const d=a.createLinearGradient(0,0,t.width,t.height);d.addColorStop(0,"#f8fafc"),d.addColorStop(1,"#e2e8f0"),a.fillStyle=d,a.fillRect(0,0,t.width,t.height);for(let o=0;o<3;o++)a.beginPath(),a.moveTo(Math.random()*t.width,Math.random()*t.height),a.lineTo(Math.random()*t.width,Math.random()*t.height),a.strokeStyle=`rgba(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, 0.3)`,a.lineWidth=1,a.stroke();a.font="bold 20px Arial",a.textAlign="center",a.textBaseline="middle";for(let o=0;o<r.length;o++){const _=r[o],k=t.width/4*o+t.width/8,v=t.height/2+(Math.random()-.5)*6,i=(Math.random()-.5)*.3;a.save(),a.translate(k,v),a.rotate(i),a.fillStyle=`hsl(${Math.floor(Math.random()*360)}, 70%, 45%)`,a.fillText(_,0,0),a.restore()}for(let o=0;o<50;o++)a.beginPath(),a.arc(Math.random()*t.width,Math.random()*t.height,1,0,2*Math.PI),a.fillStyle=`rgba(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, 0.5)`,a.fill()},p=()=>{L(),s.captcha=""},R=r=>r.toLowerCase()===z.value.toLowerCase(),A=async()=>{b.value&&await b.value.validate(async r=>{if(r){if(!R(s.captcha)){u.error("验证码错误，请重新输入"),p();return}f.value=!0;try{const t=await V.login({username:s.username,password:s.password});if(t.success)if(t.isAdmin)u.success("管理员登录成功"),M.push("/admin");else{if(B.value){V.logout(),u.error("系统维护中，仅允许管理员登录"),p();return}u.success("登录成功"),M.push("/dashboard")}else t.requireSecurityKey?(u.warning("检测到IP地址变化，需要安全验证"),sessionStorage.setItem("security_verification_data",JSON.stringify(t.securityData)),sessionStorage.setItem("admin_temp_password",s.password),M.push("/security-verification")):(u.error(t.message||"登录失败"),p())}finally{f.value=!1}}})};return q(()=>{S.checkMaintenanceMode(),setTimeout(()=>{L()},100)}),(r,t)=>{const a=c("el-input"),d=c("el-form-item"),o=c("el-checkbox"),_=c("el-button"),k=c("el-form"),v=c("router-link");return g(),m("div",G,[t[24]||(t[24]=e("div",{class:"background-decoration"},[e("div",{class:"decoration-shape shape-1"}),e("div",{class:"decoration-shape shape-2"}),e("div",{class:"decoration-shape shape-3"})],-1)),e("div",Z,[t[23]||(t[23]=x('<div class="brand-section" data-v-79f8cd58><div class="brand-logo" data-v-79f8cd58><div class="logo-icon" data-v-79f8cd58><svg width="48" height="48" viewBox="0 0 48 48" fill="none" data-v-79f8cd58><path d="M24 4L44 14V34L24 44L4 34V14L24 4Z" stroke="currentColor" stroke-width="2" fill="none" data-v-79f8cd58></path><path d="M24 12L36 18V30L24 36L12 30V18L24 12Z" stroke="currentColor" stroke-width="1.5" fill="none" data-v-79f8cd58></path><circle cx="24" cy="24" r="4" fill="currentColor" data-v-79f8cd58></circle></svg></div><h1 class="brand-title" data-v-79f8cd58>SecureCard</h1><p class="brand-subtitle" data-v-79f8cd58>企业级卡密管理系统</p></div></div>',1)),e("div",D,[t[21]||(t[21]=e("div",{class:"form-header"},[e("h2",null,"登录您的账户"),e("p",null,"欢迎回来，请输入您的登录信息")],-1)),B.value?(g(),m("div",J,t[7]||(t[7]=[x('<div class="maintenance-alert" data-v-79f8cd58><div class="alert-icon" data-v-79f8cd58><svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" data-v-79f8cd58><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" data-v-79f8cd58></path></svg></div><div class="alert-content" data-v-79f8cd58><h4 data-v-79f8cd58>系统维护中</h4><p data-v-79f8cd58>当前系统正在进行维护，仅允许管理员登录。普通用户请稍后重试。</p></div></div>',1)]))):I("",!0),l(k,{model:s,rules:H,ref_key:"loginFormRef",ref:b,class:"login-form",onKeyup:E(A,["enter"])},{default:n(()=>[l(d,{prop:"username",class:"form-field"},{default:n(()=>[t[9]||(t[9]=e("div",{class:"field-label"},[e("label",null,"用户名")],-1)),e("div",O,[t[8]||(t[8]=e("div",{class:"input-prefix"},[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),l(a,{modelValue:s.username,"onUpdate:modelValue":t[0]||(t[0]=i=>s.username=i),placeholder:"输入用户名或邮箱",class:"custom-input"},null,8,["modelValue"])])]),_:1,__:[9]}),l(d,{prop:"password",class:"form-field"},{default:n(()=>[e("div",Q,[t[10]||(t[10]=e("label",null,"密码",-1)),e("a",{href:"#",class:"forgot-link",onClick:t[1]||(t[1]=y(()=>{},["prevent"]))},"忘记密码？")]),e("div",W,[t[11]||(t[11]=e("div",{class:"input-prefix"},[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM15.1 8H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2z"})])],-1)),l(a,{modelValue:s.password,"onUpdate:modelValue":t[2]||(t[2]=i=>s.password=i),type:"password",placeholder:"输入密码","show-password":"",class:"custom-input"},null,8,["modelValue"])])]),_:1}),l(d,{prop:"captcha",class:"form-field"},{default:n(()=>[t[14]||(t[14]=e("div",{class:"field-label"},[e("label",null,"验证码")],-1)),e("div",j,[e("div",X,[t[12]||(t[12]=e("div",{class:"input-prefix"},[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),l(a,{modelValue:s.captcha,"onUpdate:modelValue":t[3]||(t[3]=i=>s.captcha=i),placeholder:"输入验证码",class:"custom-input",maxlength:"4"},null,8,["modelValue"])]),e("div",Y,[e("canvas",{ref_key:"captchaCanvas",ref:C,class:"captcha-canvas",width:"120",height:"40",onClick:p,title:"点击刷新验证码"},null,512)]),e("button",{type:"button",class:"refresh-btn",onClick:p,title:"刷新验证码"},t[13]||(t[13]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})],-1)]))])]),_:1,__:[14]}),e("div",tt,[l(o,{modelValue:s.remember,"onUpdate:modelValue":t[4]||(t[4]=i=>s.remember=i),class:"remember-checkbox"},{default:n(()=>t[15]||(t[15]=[w(" 记住我7天 ",-1)])),_:1,__:[15]},8,["modelValue"])]),l(_,{type:"primary",loading:f.value,onClick:A,class:"login-button"},{default:n(()=>[f.value?(g(),m("span",at,"正在验证...")):(g(),m("span",et,"登录账户"))]),_:1},8,["loading"])]),_:1},8,["model"]),t[22]||(t[22]=x('<div class="form-divider" data-v-79f8cd58><span data-v-79f8cd58>或</span></div><div class="alternative-actions" data-v-79f8cd58><button class="alt-button" data-v-79f8cd58><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-v-79f8cd58><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4" data-v-79f8cd58></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853" data-v-79f8cd58></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05" data-v-79f8cd58></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335" data-v-79f8cd58></path></svg> 使用Google登录 </button></div>',2)),e("div",st,[e("p",null,[t[17]||(t[17]=w("还没有账户？ ",-1)),l(v,{to:"/register",class:"signup-link"},{default:n(()=>t[16]||(t[16]=[w("免费注册",-1)])),_:1,__:[16]})]),e("div",ot,[l(v,{to:"/",class:"footer-link"},{default:n(()=>t[18]||(t[18]=[w("返回首页",-1)])),_:1,__:[18]}),t[19]||(t[19]=e("span",{class:"divider"},"•",-1)),e("a",{href:"#",class:"footer-link",onClick:t[5]||(t[5]=y(()=>{},["prevent"]))},"帮助中心"),t[20]||(t[20]=e("span",{class:"divider"},"•",-1)),e("a",{href:"#",class:"footer-link",onClick:t[6]||(t[6]=y(()=>{},["prevent"]))},"隐私政策")])])])])])}}},nt=T(lt,[["__scopeId","data-v-79f8cd58"]]);export{nt as default};
